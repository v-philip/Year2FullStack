<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>
    <script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js
        integrity=”sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q”
        crossorigin=”anonymous”></script>

    <script src=”https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js”
        integrity=”sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl”
        crossorigin=”anonymous”></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fifa Womans World cup </title>
    <style>
        #map {
            position: relative;
            height: 100%;
            width: 100%;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #stadiums {

            width: 400px;
            height: 300px;
            margin: 0;
            padding: 0;
            overflow: hidden;
            overflow: scroll;
            position: absolute;
            top: 25%;
            right: 15px;
            z-index: 3999;
            background-color: white;
            justify-content: center;

        }

        .hide {
            display: none;
        }

        .stadium {
            width: 98%;
            height: 98%;
            justify-content: center;
            align-items: center;
            margin: auto;
            border-radius: 10px;
            background-color: rgba(239, 217, 52, 0.359);
            overflow: hidden;
        }

        .stadium img {
            height: fit-content;


            border-radius: 10px;
        }

        .stadium:hover {
            background-color: rgba(239, 217, 52, 1);
        }

        .stadium p {
            font-size: medium;
            font-weight: bold;
        }


        button {
            align-items: center;
            appearance: none;
            background-color: #fff;
            border: 1px solid #dbdbdb;
            border-radius: .375em;
            box-shadow: none;
            box-sizing: border-box;
            color: #363636;
            cursor: pointer;
            display: inline-flex;
            font-family: BlinkMacSystemFont, -apple-system, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 1rem;
            height: 2.5em;
            justify-content: center;
            line-height: 1.5;
            padding: calc(.5em - 1px) 1em;
            position: absolute;
            text-align: center;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            vertical-align: top;
            white-space: nowrap;
            z-index: 1;
            top: 15%;
            right: 15px;

        }

        button:active {
            border-color: #4a4a4a;
            outline: 0;
        }

        button:focus {
            border-color: #485fc7;
            outline: 0;
        }

        button:hover {
            border-color: #b5b5b5;
        }

        button:focus:not(:active) {
            box-shadow: rgba(72, 95, 199, .25) 0 0 0 .125em;
        }

        .navbar-custom {
            background-color: rgb(255, 154, 0)
        }

        .element {
            width: 100px;
            height: 100px;
        }

        /* media query for larger screens */
        @media (max-width: 768px) {
            #stadiums {
                width: 200px;
                height: 200px;
            }
        }

        ul,
        li {

            font-size: 30px;
            font-weight: bold;
            margin: 10px;
            margin-top: 50px;
            font-family: 'Readex Pro', sans-serif;
        }
    </style>

    <script async
        src=https://maps.googleapis.com/maps/api/js?key=AIzaSyCPNWtWAqzzab1WPbr5M0rKU6NYNZVOvYQ&callback=loadMap&libraries=localContext,places&v=beta&callback=loadMap>
        </script>


    <script>

        let locations = {
            "Adelaide, Australia – Hindmarsh Stadium": {
                "latitude": -34.9073,
                "longitude": 138.5958,
                "place_id": "ChIJu9ujgk3PsGoRAG-6RVU2Aw8"
            },
            "Brisbane, Australia – Brisbane Stadium": {
                "latitude": -27.4580,
                "longitude": 153.0099,
                "place_id": "ChIJC5L-7atQkWsRALUh11ujAg8"
            },
            "Melbourne, Australia – AAMI Park": {
                "latitude": -37.8253,
                "longitude": 144.9833,
                "place_id": "ChIJaQ_iGJZC1moRc0d9A6mojJc"

            },
            "Perth, Australia – Perth Rectangular Stadium": {
                "latitude": -31.9448,
                "longitude": 115.8355,
                "place_id": "ChIJEWAFm9u6MioRFvGLqG5U3KM"
            },

            "AZN Stadium": {
                "latitude": -33.8472,
                "longitude": 151.0634,
                "place_id": "ChIJp-0oJxylEmsRdu3tWHekYQ0"
            },
            "Allianz Stadium": {
                "latitude": -33.8938,
                "longitude": 151.2242,
                "place_id": "ChIJFdVgXwKuEmsR487D1VwluxM"
            },

            "Auckland, New Zealand – Eden Park": {
                "latitude": -36.8724,
                "longitude": 174.7447,
                "place_id": "ChIJCZ7JArJHDW0RdptFyWybd74"
            },
            "Dunedin, New Zealand – Dunedin Stadium": {
                "latitude": -45.8672,
                "longitude": 170.5071,
                "place_id": "ChIJuZVBRkGsLqgRE4Zw34pRKIQ"
            },
            "Hamilton, New Zealand – Waikato Stadium": {
                "latitude": -37.7866,
                "longitude": 175.2793,
                "place_id": "ChIJs1ZnkAsibW0RoOG02ReaEpk"

            },
            "Wellington, New Zealand – Wellington Regional Stadium": {
                "latitude": -41.2745,
                "longitude": 174.7831,
                "place_id": "ChIJR7KXhDquOG0RuEC90I2oEy0"
            }
        };

        function metersToDegrees(meters) // generated by ChatGPT
        {
            const earthRadius = 6371000 // Earth's radius in meters
            const degreesPerRadian = 180 / Math.PI

            const degrees = meters * degreesPerRadian / earthRadius
            return degrees
        }
        let map = null
        let serviceP = null
        let pressed = null
        var place = ""
        var hotelLocation = {}
        if (pressed == null) {
            firstLocation = Object.entries(locations)[0][1]; // get the value of the first key-value pair
            hotelLocation = { lat: firstLocation.latitude, lng: firstLocation.longitude };
            place = firstLocation.place_id;
        }



        function loadMap() {
            map = new google.maps.Map(document.getElementById("map"))
            let icon = {
                url: "icon.png",
                scaledSize: new google.maps.Size(55, 55)
            }

            const degrees = metersToDegrees(3000)

            const bounds = {
                north: hotelLocation.lat + degrees,
                south: hotelLocation.lat - degrees,
                west: hotelLocation.lng - degrees,
                east: hotelLocation.lng + degrees
            }

            const localContextMapView = new google.maps.localContext.LocalContextMapView({
                element: document.getElementById("map"),
                placeTypePreferences: [
                    { type: "cafe" },
                    { type: "tourist_attraction" },
                    { type: "bank" }
                ],
                maxPlaceCount: 24,
                locationRestriction: bounds,
                directionsOptions: { origin: hotelLocation } // Walking route starts at hotelLocation
            })

            let localContextMap = localContextMapView.map

            localContextMap.setOptions({
                center: hotelLocation, // Map is centred on Dundalk
                zoom: 14
            })


            let infoWindow = new google.maps.InfoWindow()
            let marker = new google.maps.Marker({
                position: hotelLocation,
                map: localContextMap,
                icon: icon,
                zIndex: 30,

            })
            google.maps.event.addListener(marker, "click", () => {
                let serviceP = new google.maps.places.PlacesService(map)
                let URL = "";
                serviceP.getDetails({ placeId: place }, (place_id, status) => {
                    if (status === google.maps.places.PlacesServiceStatus.OK) {
                        console.log(place_id)
                        infoWindow.setContent(`<div id=content>
                                             <img  class="marker" src = ${place_id.photos[0].getUrl({ maxWidth: 200, maxHeight: 200 })}>
                                             <p class mae>${place_id.name}</p>
                                             
                                        </div>`)
                        marker.setTitle(place_id.name)
                    }
                })

                infoWindow.open(map, marker);
                //to pan with zoom
                map.setZoom(17);





            })

            serviceP = new google.maps.places.PlacesService(map)
            let stadiums = document.getElementById("stadiums")

            let url = ""
            stadiums.innerHTML = ""

            for (const [key, value] of Object.entries(locations)) {
                serviceP.getDetails({ placeId: value.place_id }, (place, status) => {
                    if (status === google.maps.places.PlacesServiceStatus.OK) {
                        url = place.photos[0].getUrl({ maxWidth: 200, maxHeight: 200 })
                    }

                    var htmlString = `<div class='stadium' onclick="moveTo(${value.latitude},${value.longitude},'${value.place_id}')"><p>${key}</p><img src="${url}" class="card-img-top" alt="${url}"></div>`
                    stadiums.innerHTML += htmlString
                })

            }



            // const input = document.getElementById("pac-input");
            // // Specify just the place data fields that you need.
            // const autocomplete = new google.maps.places.Autocomplete(input, {
            //     fields: ["place_id", "geometry", "formatted_address", "name"],
            // });

            // autocomplete.bindTo("bounds", map);
            // map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            // const infowindow = new google.maps.InfoWindow();
            // const infowindowContent = document.getElementById("infowindow-content");

            // infowindow.setContent(infowindowContent);

            // marker = new google.maps.Marker({ map: map });

            // marker.addListener("click", () => {
            //     infowindow.open(map, marker);
            // });
            // autocomplete.addListener("place_changed", () => {
            //     infowindow.close();

            //     const place = autocomplete.getPlace();

            //     if (!place.geometry || !place.geometry.location) {
            //         return;
            //     }

            //     if (place.geometry.viewport) {
            //         map.fitBounds(place.geometry.viewport);
            //     } else {
            //         map.setCenter(place.geometry.location);
            //         map.setZoom(17);
            //     }

            //     // Set the position of the marker using the place ID and location.
            //     // @ts-ignore This should be in @typings/googlemaps.
            //     marker.setPlace({
            //         placeId: place.place_id,
            //         location: place.geometry.location,
            //     });
            //     marker.setVisible(true);
            //     infowindowContent.children.namedItem("place-name").textContent = place.name;
            //     infowindowContent.children.namedItem("place-id").textContent =
            //         place.place_id;
            //     infowindowContent.children.namedItem("place-address").textContent =
            //         place.formatted_address;
            //     infowindow.open(map, marker);
            // });

        }
        function moveTo(lat, lng, place_id) {
            pressed = true;
            hotelLocation = { lat: lat, lng: lng }
            place = place_id;
            console.log("test")
            loadMap()
        }
        function toggleDiv() {
            var myDiv = document.getElementById("stadiums");
            myDiv.classList.toggle("hide");
        }

        // function showAttraction(){
        //     var filter = document.getElementById("filter");

        // }




    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-custom" style="color:rgb(255, 131, 1)">
        <a class="navbar-brand" href="fifa.html"><img src="logo.png"
                style="height: fit-content;width: 100px; margin-left:5%;"> </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="fifa.html">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Features</a>
                </li>
                <li class="nav-item">

            </ul>

        </div>
    </nav>
    <div id="stadiums"></div>

    <!-- <body>
        <div style="display: none">
          <input
            id="pac-input"
            class="controls"
            type="text"
            placeholder="Enter a location"
          />
        </div>
        <div id="map"></div>
    <div id="infowindow-content">
      <span id="place-name" class="title"></span><br />
      <strong>Place ID:</strong> <span id="place-id"></span><br />
      <span id="place-address"></span>
    </div> -->
    <button onclick="toggleDiv()">Stadiums</button>
    <!-- <label for="my-select">Filter POI:</label>
            <select id="filter" onchange="showAttraction()">
                <option value="cafe">Cafe</option>
                <option value="hotel">Hotel</optoin>
                <option value="bank">Bank</optoin>
                <option value="atm">ATM</optoin>
                <option value="hospital">Hospital</optoin>
            </select> -->



    <div id=map></div>

    <script>



    </script>

</body>

</html>